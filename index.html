<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Rhema Fire Generation Church</title>
<link rel="stylesheet" href="styles/main.css">
<link rel="stylesheet" href="styles/vista.css">
<style>
/* CARD STYLING */
.card {
  background: #f9fcff;
  border: 1px solid #e0e6ed;
  border-radius: 8px;
  padding: 0.5rem;
  margin: 0.8rem 0;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
  transition: transform 0.3s, box-shadow 0.3s;
}
.card:hover {
  transform: translateY(-4px);
  box-shadow: 0 6px 12px rgba(0,0,0,0.12);
}
.card img {
  width: 100%;
  max-width: 280px;
  border-radius: 6px;
  margin-top: 0.5rem;
  cursor: pointer;
}
.card h4 { margin: 0.3rem 0; font-size: 1rem; color: #0b5ed7; }
.card a { color: #0b5ed7; text-decoration: none; }
.card p { font-size: 0.875rem; color: #5f6b7a; }

/* LIGHTBOX */
#lightboxOverlay {
  display: none;
  position: fixed; top:0; left:0; width:100%; height:100%;
  background: rgba(0,0,0,0.9);
  justify-content: center;
  align-items: center;
  z-index: 9999;
}
#lightboxContent {
  max-width: 95%;
  max-height: 95%;
  position: relative;
}
#lightboxOverlay img, #lightboxOverlay video {
  max-width: 100%;
  max-height: 100%;
  border-radius: 8px;
}
#lightboxOverlay .close, #lightboxOverlay .prev, #lightboxOverlay .next {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  color: #fff;
  font-size: 2rem;
  cursor: pointer;
  user-select: none;
  padding: 0 0.5rem;
}
#lightboxOverlay .close { top: 20px; right: 20px; transform: none; }
#lightboxOverlay .prev { left: 10px; }
#lightboxOverlay .next { right: 10px; }
</style>
</head>
<body>

<header class="topbar">
  <a class="logo" href="index.html">RHEMA FIRE GENERATION CHURCH</a>
  <nav class="nav-scroll">
    <a href="about.html">About</a>
    <a href="ministries.html">Ministries</a>
    <a href="projects.html">Projects</a>
    <a href="media.html">Media</a>
    <a href="fire-news.html">ðŸ”¥ Fire News</a>
    <a href="donate.html">Give</a>
    <a href="contact.html">Contact</a>
  </nav>
</header>

<!-- HERO CAROUSEL -->
<section class="hero-carousel" id="heroCarousel">
  <div class="hero-slide active">
    <img src="assets/images/placeholder-home.jpg" alt="Hero Slide">
    <div class="hero-caption">
      <h2>Rhema Fire Conference</h2>
      <p>Encounter the Word â€¢ Experience the Fire</p>
    </div>
  </div>
  <div class="hero-slide">
    <img src="assets/images/placeholder-home.jpg" alt="Hero Slide">
    <div class="hero-caption">
      <h2>Night of Prophetic Worship</h2>
      <p>A call to prayer and revival</p>
    </div>
  </div>
</section>

<!-- AUTOPOPULATED SECTIONS -->
<section id="events-section" class="block">
  <h3>Latest Events</h3>
</section>

<section id="projects-section" class="block">
  <h3>Projects</h3>
</section>

<section id="media-section" class="block">
  <h3>Media & Sermons</h3>
</section>

<section id="fire-news-section" class="block">
  <h3>ðŸ”¥ Fire News</h3>
</section>

<section class="block">
  <h3>Daily Prayer Focus</h3>
  <p>Scripture-based prophetic prayers appear in the FIREWORD popup on first load.</p>
</section>

<footer class="footer">
  <strong>Rhema Fire Generation Church</strong><br>
  Accra, Ghana<br>
  +233 XXX XXX XXX<br>
  info@rhemafire.org
</footer>

<!-- LIGHTBOX -->
<div id="lightboxOverlay">
  <span class="close">&times;</span>
  <span class="prev">&#10094;</span>
  <span class="next">&#10095;</span>
  <div id="lightboxContent"></div>
</div>

<script src="scripts/main.js"></script>
<script src="scripts/popups.js"></script>
<script src="scripts/media-player.js"></script>
<script src="scripts/sounds.js"></script>

<script>
// ===========================
// AUTOPOPULATE + MEDIA LIGHTBOX + SWIPE CAROUSEL
// ===========================
document.addEventListener("DOMContentLoaded", () => {

  // --- HERO CAROUSEL ---
  const slides = document.querySelectorAll(".hero-slide");
  let index = 0, startX = 0, endX = 0;
  function showSlide(i){ slides.forEach((s,j)=>s.style.display=j===i?"block":"none"); }
  showSlide(index);
  setInterval(()=>{ index=(index+1)%slides.length; showSlide(index); },5000);
  const carousel=document.getElementById("heroCarousel");
  carousel.addEventListener("touchstart", e=>{ startX=e.touches[0].clientX; });
  carousel.addEventListener("touchend", e=>{ endX=e.changedTouches[0].clientX;
    if(startX-endX>50){ index=(index+1)%slides.length; showSlide(index); }
    else if(endX-startX>50){ index=(index-1+slides.length)%slides.length; showSlide(index); } });

  // --- SCROLL REVEAL ---
  const blocks=document.querySelectorAll(".block");
  const reveal=()=>{ blocks.forEach(b=>{ const r=b.getBoundingClientRect(); if(r.top<window.innerHeight*0.9)b.classList.add("fade-in"); }); }
  window.addEventListener("scroll",reveal); reveal();

  // --- AUTOPOPULATE SECTIONS ---
  function populate(sectionId,jsonFile,createCard){ const section=document.querySelector(sectionId);
    fetch(jsonFile).then(r=>r.json()).then(items=>{ items.slice(0,3).forEach(item=>{
      const div=document.createElement("div"); div.className="card slide-up"; div.innerHTML=createCard(item); section.appendChild(div);
    }); });
  }

  populate("#events-section","config/events.json",item=>`<h4>${item.title} (${item.date})</h4><p>${item.description}</p><a href="projects.html">Read more â†’</a>`);
  populate("#projects-section","config/projects.json",item=>`<h4>${item.title} (${item.date})</h4><p>${item.summary}</p><a href="projects.html">Read more â†’</a>`);
  populate("#media-section","config/media.json",item=>`<h4>${item.title}</h4><a href="${item.link}"><img src="${item.thumbnail}" alt="${item.title}" data-type="${item.type}" data-src="${item.link}"></a>`);
  populate("#fire-news-section","config/fire-news.json",item=>`<h4><a href="${item.link}" target="_blank">${item.title}</a></h4><p>${item.summary}</p>`);

  // --- LIGHTBOX ---
  const overlay=document.getElementById("lightboxOverlay");
  const content=document.getElementById("lightboxContent");
  const closeBtn=overlay.querySelector(".close");
  const prevBtn=overlay.querySelector(".prev");
  const nextBtn=overlay.querySelector(".next");
  let mediaItems=[], currentIndex=0;

  // Click media thumbnail
  document.getElementById("media-section").addEventListener("click", e=>{
    if(e.target.tagName==="IMG"){
      mediaItems=Array.from(document.querySelectorAll("#media-section img"));
      currentIndex=mediaItems.indexOf(e.target);
      openLightbox();
    }
  });

  function openLightbox(){
    const img=e=>mediaItems[e];
    const type=mediaItems[currentIndex].dataset.type;
    const src=mediaItems[currentIndex].dataset.src;
    content.innerHTML="";
    if(type==="video"){ const v=document.createElement("video"); v.src=src; v.controls=true; v.autoplay=true; content.appendChild(v); }
    else{ const i=document.createElement("img"); i.src=src; content.appendChild(i); }
    overlay.style.display="flex";
  }

  function showMedia(idx){ currentIndex=(idx+mediaItems.length)%mediaItems.length; openLightbox(); }

  closeBtn.onclick=()=>overlay.style.display="none";
  prevBtn.onclick=()=>showMedia(currentIndex-1);
  nextBtn.onclick=()=>showMedia(currentIndex+1);

  // Swipe inside lightbox
  let lx=0, ex=0;
  overlay.addEventListener("touchstart",e=>{ lx=e.touches[0].clientX; });
  overlay.addEventListener("touchend",e=>{ ex=e.changedTouches[0].clientX;
    if(lx-ex>50) showMedia(currentIndex+1);
    else if(ex-lx>50) showMedia(currentIndex-1);
  });
});
</script>

</body>
</html>
